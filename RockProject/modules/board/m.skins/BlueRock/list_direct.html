{@$ncnt = $cnt}
<ul class="lt">
    <!--@foreach($document_list as $no => $document)-->
    <li>
        <a id="{$cnt}" class="main_button{$page} mb" name="{getUrl('document_srl', $document->document_srl,'Content_Num',$cnt)}">
            <span class="title">
                {$no} &rsaquo;
                <!--@if($module_info->use_category == "Y" && $document->get('category_srl'))-->
                {$category_list[$document->get('category_srl')]->title} &rsaquo;
                <!--@end-->
                <strong>{$document->getTitle($module_info->subject_cut_size)}</strong>
                <!--@if($document->getCommentCount())-->
                <span>[{$document->getCommentCount()}]</span>
                <!--@endif-->
            </span>
            <span class="auth">
                <em>{$document->getNickName()}</em>
                <span>{$document->getRegDate("Y.m.d")}</span>
            </span>
        </a>
        <div class="Notes" hidden="true" data-name="not-open">
        </div>
    </li>
    {@$cnt = $cnt + 1}
    <!--@end-->
</ul>
<!--@if($ncnt != $cnt)-->
<div class="page-{$page}" name="{getUrl('mid',$mid,'document_srl','','page',$page+1,'cnt',$cnt)}">

</div>
<!--@endif-->
<script>
    jQuery(function($){
        $('.main_button{$page}').click(function() {
            $rak_str = '#Notes-' + this.id.toString();
            $rak_link = this.name.toString();
//            $('p.debug').html('str = ' + $rak_str + '<br>' + 'link = ' + $rak_link);
//            if($(this).next())
            $(this).next().toggle();
            $rak_name = $(this).next().data().name.toString();
            if ($rak_name === "not-open") {
                $(this).next().load($rak_link);
                $(this).next().data().name = "open";
            }else if($rak_name === "open"){
                $(this).next().html("");
                $(this).next().data().name = "not-open";
            }
        });

        <!--@if($ncnt != $cnt)-->
            function loadMore() {
                str = '.page-' + {$page};
                if ($(str).attr('name') != 'opened') {
                    go_str = $(str).attr('name').toString();
                    $(str).load(go_str);
                    $(str).attr('name','opened');
                }
            }

            function bindScroll(){
                if($(window).scrollTop() + $(window).height() > $(document).height() - 100) {
                    $(window).unbind('scroll');
                    loadMore();
                }
            }
            if($(window).scrollTop() + $(window).height() > $(document).height() - 100) {
                $(window).unbind('scroll');
                loadMore();
            }
            $(window).scroll(bindScroll);
        <!--@endif-->
    });
</script>