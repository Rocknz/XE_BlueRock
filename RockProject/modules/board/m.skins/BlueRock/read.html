<load target="css/mboard.css"/>
<load target="js/mboard.js"/>
<!--%import("js/bootstrap.min.js")-->

<nav class="navbar navbar-default navbar-fixed-top" >
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="true">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class = "navbar-brand" href="{$layout_info->index_url}"|cond="$layout_info->index_url" href="{geturl('')}"|cond="!$layout_info->index_url">
                <!--@if($layout_info->logo_image)-->
                <img src="{$layout_info->logo_image}" alt="{$layout_info->index_title}"|cond="$layout_info->index_title" alt="{Context::getSiteTitle()}"|cond="!$layout_info->index_title && Context::getSiteTitle()" />
                <!--@elseif($layout_info->index_title)-->
                <a href="{$layout_info->index_url}">{$layout_info->index_title}</a>
                <!--@elseif(Context::getSiteTitle())-->
                {Context::getSiteTitle()}
                <!--@else-->
                Mobile XE
                <!--@end-->
            </a>
        </div>
        <!--@if($main_menu != null) -->
        <div class="navbar-collapse collapse" id="bs-example-navbar-collapse-1" aria-expanded="true" style="">
            <ul class="nav navbar-nav navbar-right">
                <!--@foreach($main_menu->list as $val1) -->
                <!--@if($val1['list'])-->
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">{$val1['link']}<span class="caret"></span></a>
                    <ul class="dropdown-menu" role="menu">
                        <li class="active"|cond="$val1['selected']">
                            <a href="{$val1['href']}" target="_blank"|cond="$val1['open_window']=='Y'">{$val1['link']}</a>
                        </li>
                        <li class="divider"></li>
                        <!--@foreach($val1['list'] as $val2)-->
                        <li class="active"|cond="$val2['selected']">
                            <a href="{$val2['href']}" target="_blank"|cond="$val2['open_window']=='Y'">{$val2['link']}</a>
                        </li>
                        <!--@end-->
                    </ul>
                </li>
                <!--@else-->
                <li class="active"|cond="$val1['selected']">
                    <a href="{$val1['href']}" target="_blank"|cond="$val1['open_window']=='Y'">{$val1['link']}</a>
                </li>
                <!--@endif-->
                <!--@end-->
            </ul>
        </div>
        <!--@endif-->
    </div>
</nav>
<br><br><br>
<div class="hx h2">
    <h2><a href="{getUrl('document_srl','','category','','page','')}">{$module_info->browser_title}</a>
        <!--@if($module_info->use_category == "Y" && $oDocument->get('category_srl'))-->&rsaquo; <a href="{getUrl('document_srl','','category',$oDocument->get('category_srl'))}">{$category_list[$oDocument->get('category_srl')]->title}</a><!--@end--> &rsaquo; {$oDocument->getTitle()}</h2>
    <span class="ex">{$oDocument->getNickName()} | {$oDocument->getRegdate()} | <a href="#skip_co">{$lang->skip_to_content}</a></span>
    <a href="{getUrl('act','dispBoardWrite','document_srl','')}" class="write">{$lang->cmd_write}</a>
</div>
<div class="co">
    <!--@if($oDocument->isSecret() && !$oDocument->isGranted())-->
    <form action="./" method="get" class="ff" onsubmit="return procFilter(this, input_password)">
        <input type="hidden" name="mid" value="{$mid}" />
        <input type="hidden" name="page" value="{$page}" />
        <input type="hidden" name="document_srl" value="{$oDocument->document_srl}" />
        <label for="cpw">{$lang->msg_is_secret}</label>
        <input type="password" name="password" id="cpw" />
        <input type="submit" value="{$lang->cmd_input}" class="bn dark" />
    </form>
    <!--@else-->
    <!--@if($oDocument->isExtraVarsExists())-->
    {@ $_extra_vars = $oDocument->getExtraVars(); }
    <dl class="xv">
        <!--@foreach($_extra_vars as $key => $val)-->
        <dt>{$val->name}</dt>
        <dd>{$val->getValueHTML()}</dd>
        <!--@end-->
    </dl>
    <!--@end-->
    {$oDocument->getContent(false)}
    <!--@end-->
</div>
<div id="skip_co"></div>
<!--@if($oDocument->hasUploadedFiles())-->
{@ $uploaded_list = $oDocument->getUploadedFiles() }
<div class="hx h3">
    <h3>{$lang->uploaded_file} <em>[{count($uploaded_list)}]</em></h3>
    <button type="button" class="tg" title="open/close"></button>
</div>
<ul class="file tgo open">
    <!--@foreach($uploaded_list as $key => $file)-->
    <li><a href="{getUrl('')}{$file->download_url}">{$file->source_filename} <span class="size">{FileHandler::filesize($file->file_size)}</span></a></li>
    <!--@end-->
</ul>
<!--@endif-->
<!--@if($oDocument->allowTrackback() && $oDocument->getTrackbackCount())-->
<div class="hx h3">
    <h3>{$lang->trackback} <em>[{$oDocument->getTrackbackCount()}]</em></h3>
    <button type="button" class="tg" title="open/close"></button>
</div>
<ul class="rp tgo open">
    {@ $_trackback_list = $oDocument->getTrackbacks() }
    <!--@foreach($_trackback_list as $key => $val)-->
    <li>
        <p>{$val->excerpt}</p>
		<span class="auth">
			<em>{htmlspecialchars($val->title)} - {htmlspecialchars($val->blog_name)}</em>
			<span class="time">{zdate($val->regdate, "Y.m.d")}</span>
            <!--@if($grant->manager)-->
			<a href="07_password.html" class="btn de">{$lang->cmd_delete}</a>
            <!--@endif-->
		</span>
    </li>
    <!--@end-->
</ul>
<!--@endif-->

<!--//Comment!!! -->

<!--@if($oDocument->getCommentCount())-->
    <button class="tg tgr btn btn-primary" title="open/close">
        {$lang->comment}[{$oDocument->getCommentCount()}]
    </button>
    <div id="Comment_Set" class="tgo" hidden="true">

    </div>
<!--@endif-->


<!--@if($grant->write_comment && $oDocument->isEnableComment() )-->
    <button class="tg btn btn-primary" title="open/close">
        {$lang->write_comment}
    </button>

    <form action="./" method="POST" class="sn tgo open" onsubmit="return procFilter(this, insert_comment);" hidden="true">
        <input type="hidden" name="mid" value="{$mid}" />
        <input type="hidden" name="document_srl" value="{$oDocument->document_srl}" />
        <input type="hidden" name="comment_srl" value="" />
        <ul>
            <li>
                <label for="rText" class="db fb">{$lang->comment}</label>
                <textarea name="content" rows="8" cols="42" id="rText" class="itxx"></textarea>
            </li>
            <!--@if(!$is_logged)-->
            <li>
                <label for="uName" class="db fb">{$lang->writer}</label>
                <input name="nick_name" type="text" id="uName" class="itx" />
            </li>
            <li>
                <label for="uMail" class="db fb">{$lang->email_address}</label>
                <input name="email_address" type="email" id="uMail" class="itx" />
            </li>
            <li>
                <label for="uPw" class="db fb">{$lang->password}</label>
                <input name="password" type="password" id="uPw" class="itx" />
            </li>
            <li>
                <label for="uSite" class="db fb">{$lang->homepage}</label>
                <input name="homepage" type="url" id="uSite" class="itx" value="" />
            </li>
            <!--@endif-->
        </ul>
        <div class="ar">
            <input name="" type="submit" value="{$lang->cmd_comment_registration}" />
        </div>
    </form>
<!--@end-->

<div style="height:1px;overflow:hidden;background:#ddd"></div>
<div class="bna">
    <span class="fl"><a href="{getUrl('document_srl','')}" class="bn white">{$lang->cmd_list}</a></span>
	<span class="fr">
		<!--@if($oDocument->isEditable())-->
		<a href="{getUrl('act','dispBoardDelete','document_srl',$oDocument->document_srl,'comment_srl','')}" class="bn white">{$lang->cmd_delete}</a>
        <!--@end-->
	</span>
    </ul>
</div>
<script>
    //<![CDATA[
    jQuery(function($){
        $str = '.tg';
        $($str).click(function(){
            $('p.debug').html("click");
            $(this).next('.tgo').toggle();
        });
        $str2 = '.tgr';
        $($str2).click(function(){
            {@ $lastpage = 1; }
            {@ $temp = $oDocument->getComments() }
            <!--@if($oDocument->comment_page_navigation)-->
                {@ $lastpage = $oDocument->comment_page_navigation->last_page }
            <!--@endif-->
            loadCommentPage({$oDocument->document_srl}, {$lastpage});
        });
        function loadCommentPage(document_srl, page)
        {
            var params = {};
            params.cpage = page;
            params.document_srl = document_srl;
            params.mid = current_mid;
            jQuery.exec_json('board.getBoardCommentPage', params, completeCommentGetPage);
        }
        function completeCommentGetPage(ret_val)
        {
            jQuery("#Comment_Set").html(ret_val.html);
        }
    });
    //]]>
</script>
